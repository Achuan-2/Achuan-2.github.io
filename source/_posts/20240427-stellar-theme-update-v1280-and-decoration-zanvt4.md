---
title: Hexo stellarä¸»é¢˜æ›´æ–° v1.28.0 åŠä¸ªæ€§åŒ–ä¿®æ”¹
date: '2024-04-27 12:33:25'
updated: '2024-04-27 18:36:29'
permalink: /post/20240427-stellar-theme-update-v1280-and-decoration-zanvt4.html
comments: true
toc: true
excerpt: >-
  stellar
  ä¸»é¢˜æœ‰æ®µæ—¶é—´å¤§æ”¹æ ·å¼ï¼Œå½“æ—¶æ²¡æ—¶é—´æ›´æ–°ä¸»é¢˜ã€‚æ„Ÿè§‰ç°åœ¨ä¸»é¢˜æ¯”è¾ƒç¨³å®šäº†ï¼Œç»ˆäºæ‰¾åˆ°æ—¶é—´æŠŠä¸»é¢˜æ›´æ–°ä¸€ä¸‹ã€‚ç”±äºstellarç»è¿‡ä½œè€…å¤§æ”¹ï¼Œæˆ‘ä¹‹å‰çš„å¾ˆå¤šçš„è‡ªå®šä¹‰æ ·å¼éƒ½å¤±æ•ˆäº†ã€‚æ‰€ä»¥åˆæŠ˜è…¾äº†ä¸€ä¸Šåˆï¼Œé‡æ–°ç¾åŒ–äº†ä¸€ä¸‹ã€‚
tags:
  - æŠ˜è…¾
  - Hexo
  - åšå®¢
  - ç¼–ç¨‹
  - å‰ç«¯
categories:
  - å…¶ä»–ç¬”è®°
---



Hexo stellar ä¸»é¢˜æœ‰æ®µæ—¶é—´å¤§æ”¹æ ·å¼ï¼Œå½“æ—¶æ²¡æ—¶é—´æ›´æ–°ä¸»é¢˜ã€‚æ„Ÿè§‰ç°åœ¨ä¸»é¢˜æ¯”è¾ƒç¨³å®šäº†ï¼Œç»ˆäºæ‰¾åˆ°æ—¶é—´æŠŠä¸»é¢˜æ›´æ–°ä¸€ä¸‹ã€‚ç”±äºstellarç»è¿‡ä½œè€…å¤§æ”¹ï¼Œæˆ‘ä¹‹å‰å†™çš„å¾ˆå¤šè‡ªå®šä¹‰æ ·å¼éƒ½å¤±æ•ˆäº†ã€‚æ‰€ä»¥æŠ˜è…¾äº†ä¸€ä¸Šåˆï¼Œé‡æ–°ç¾åŒ–äº†ä¸€ä¸‹ã€‚å¸Œæœ›è‡ªå·±ä»¥ååšæŒæ¯å‘¨éƒ½å†™ä¸€ç¯‡åšå®¢å§ğŸ¦ã€‚

## åšå®¢ç•Œé¢

### ç›®å‰çš„åšå®¢æ ·å¼

â€‹![Clip_2024-04-27_12-14-58](https://raw.githubusercontent.com/Achuan-2/Picbed/pic/assets/Clip_2024-04-27_12-14-58-20240427121503-vlzsk3v.png "ä¸»é¡µ")â€‹

â€‹![Clip_2024-04-27_11-19-05](https://raw.githubusercontent.com/Achuan-2/Picbed/pic/assets/Clip_2024-04-27_11-19-05-20240427111907-krckfdm.png "æ–‡ç« å†…")â€‹

### ä¹‹å‰çš„å†å²å¿«ç…§

â€‹![image](https://raw.githubusercontent.com/Achuan-2/Picbed/pic/assets/image-20230926104442-ig83unh.png "2023.09.26")â€‹

â€‹![image](https://raw.githubusercontent.com/Achuan-2/Picbed/pic/assets/image-20231105162526-h0wksqr.png "2023.11.05")â€‹

## ç›®å‰æˆ‘æ˜¯æ€ä¹ˆå‘Hexoåšå®¢çš„

ç°åœ¨æˆ‘åŸºæœ¬æ˜¯ä½¿ç”¨ã€Œ[æ€æºç¬”è®°](https://github.com/siyuan-note/siyuan)ã€æ¥ç®¡ç†ç¬”è®°å’Œå†™åšå®¢ï¼Œè¿™æ˜¯ä¸€ä¸ªç®¡ç†å’Œç¼–è¾‘ä½“éªŒå¾ˆå¥½çš„åŒé“¾ç¬”è®°è½¯ä»¶ã€‚æ€æºç¬”è®°æœ‰ä¸€ä¸ªã€Œ[å‘å¸ƒå·¥å…·](https://github.com/terwer/siyuan-plugin-publisher)ã€æ’ä»¶ï¼Œå¯ä»¥å¾ˆä¾¿æ·çš„æŠŠæ€æºç¬”è®°é‡Œçš„æ–‡ç« ä¸Šä¼ åˆ°å„ä¸ªå¹³å°ï¼Œéå¸¸çœå¿ƒï¼Œå†ç»“åˆæ€æºç¬”è®°çš„æ•°æ®åº“åŠŸèƒ½å¯ä»¥å¾ˆæ–¹ä¾¿çš„ç®¡ç†å‘å¸ƒçš„æ–‡ç« ã€‚

â€‹![Clip_2024-04-27_12-43-28](https://raw.githubusercontent.com/Achuan-2/Picbed/pic/assets/Clip_2024-04-27_12-43-28-20240427124338-tlz4y8f.png "å‘å¸ƒå·¥å…·")â€‹

â€‹![Clip_2024-04-27_13-02-42](https://raw.githubusercontent.com/Achuan-2/Picbed/pic/assets/Clip_2024-04-27_13-02-42-20240427130249-xfw7ivx.png "ç”¨æ€æºç¬”è®°çš„æ•°æ®åº“æ¥ç®¡ç†åšå®¢æ–‡ç« ")â€‹

## ä»£ç æ›´æ”¹è®°å½•

### Markdownå›¾ç‰‡titleæ ‡é¢˜å¤±æ•ˆ

Markdown çš„å®Œæ•´å›¾ç‰‡è¯­æ³•æ˜¯ `![anchor text](img_src "title")`â€‹ï¼Œä¸€äº›ç¬”è®°è½¯ä»¶åƒè¯­é›€ã€æ€æºç¬”è®°ç›®å‰éƒ½æ˜¯æ”¯æŒè§£ætitleä½œä¸ºå›¾ç‰‡æ ‡é¢˜çš„ï¼Œä¸€äº›hexoä¸»é¢˜å¦‚butterflyåº”è¯¥ä¹Ÿæ˜¯æ”¯æŒçš„ï¼ˆä¹Ÿæ˜¯æˆ‘æçš„å»ºè®®ï¼‰ã€‚

stellarä¹‹å‰æ˜¯æ¥å—äº†æˆ‘çš„[pull request](https://github.com/xaoxuu/hexo-theme-stellar/commit/4be3e6e123b7d22f00d5a4d419c954bb2557cf67)ï¼Œå¯ä»¥è§£æMarkdownçš„å›¾ç‰‡titleè¯­æ³•ä½œä¸ºå›¾ç‰‡æ ‡é¢˜ï¼Œ

ä½†ç°åœ¨ç›´æ¥æŠŠè§£æMarkdownæ ‡é¢˜çš„åˆ æ‰äº†ï¼ˆè§[issueè®¨è®º](https://github.com/xaoxuu/hexo-theme-stellar/issues/340)ï¼Œ[ä»£ç æ”¹åŠ¨](https://github.com/xaoxuu/hexo-theme-stellar/commit/e92cb81296e34e85d54bf26f35b6eda83d78b534)ï¼‰ã€‚

ä½œä¸ºåŸºæœ¬åªç”¨Markdownè¯­æ³•å†™åšå®¢çš„äººæ¥è¯´ï¼Œå®åœ¨å¤ªä¸å‹å¥½äº†ï¼Œæ‰€ä»¥åˆæŠŠåˆ æ‰çš„ä»£ç ç»™åŠ äº†å›æ¥ã€‚

å¹¶ä¸”æ”¹è¿›äº†ä¸‹ `themes\stellar\scripts\filters\index.js`â€‹ï¼Œå‡å°‘è¯¯æ›¿æ¢çš„æƒ…å†µå‘ç”Ÿã€‚

```js
'use strict';

hexo.extend.filter.register('after_render:html', require('./lib/img_lazyload').processSite);
hexo.extend.filter.register('after_render:html', require('./lib/img_onerror').processSite);

function change_image(data) {
    if (this.theme.config.tag_plugins.image.parse_markdown) {
        // Step 1: åˆ é™¤æ‰€æœ‰é›¶å®½ç©ºæ ¼å­—ç¬¦
        data.content = data.content.replace(/\u200B/g, '');

        // Step 2: ä¿®æ”¹æ­£åˆ™è¡¨è¾¾å¼ï¼Œåªåœ¨è¡Œé¦–æˆ–å‰é¢åªæœ‰ç©ºæ ¼å’Œç¼©è¿›æ—¶æ›¿æ¢å›¾ç‰‡é“¾æ¥
        data.content = data.content.replace(
            /^(?:\s*)!\[(.*?)\]\((.*?)\s*(?:"(.*?)")?\)/gm,
            '{% image $2 $3 %}'
        );
    }
    return data;
}



hexo.extend.filter.register('before_post_render', change_image, 9);
```

### æ·»åŠ åˆ†ç±» widget

è¿™æ ·åœ¨ä¸»é¡µå°±çŸ¥é“è‡ªå·±æ–‡ç« æœ‰å¤šå°‘åˆ†ç±»äº†

â€‹![image](https://raw.githubusercontent.com/Achuan-2/Picbed/pic/assets/image-20240427141259-4ro3r3w.png)â€‹

â€

åœ¨ `/themes/stellar/layout/_partial/widgets/`â€‹ ä¸‹æ–°å»º `categories.ejs`â€‹ï¼Œå¡«å…¥ä»¥ä¸‹å†…å®¹ï¼š

```js
<% function layoutCategoriesDiv() { var el='' ; if (site.categories===undefined || site.categories.length===0) { return
    el; } var opts=Object.assign({}, item); delete opts['title']; delete opts['layout']; opts.class='category ' ;
    el+=`<widget class="widget-wrapper${scrollreveal(' ')} categories-widget">`;

    if (item.title) {
    el += '<div class="widget-header categories-header dis-select">';
        el += '<span class="name">' + item.title + '</span>';
        el += '</div>';
    }

    el += '<div class="widget-body">';
        // Generate categories list
        site.categories.each(function(category) {
        el += `<div class="${opts.class}">`;
            el += `<svg class="category-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round">
                <path d="M18 10h-5" opacity=".5" />
                <path d="M10 3h6.5c.464 0 .697 0 .892.026a3 3 0 0 1 2.582 2.582c.026.195.026.428.026.892"
                    opacity=".5" />
                <path
                    d="M2 6.95c0-.883 0-1.324.07-1.692A4 4 0 0 1 5.257 2.07C5.626 2 6.068 2 6.95 2c.386 0 .58 0 .766.017a4 4 0 0 1 2.18.904c.144.119.28.255.554.529L11 4c.816.816 1.224 1.224 1.712 1.495a4 4 0 0 0 .848.352C14.098 6 14.675 6 15.828 6h.374c2.632 0 3.949 0 4.804.77c.079.07.154.145.224.224c.77.855.77 2.172.77 4.804V14c0 3.771 0 5.657-1.172 6.828C19.657 22 17.771 22 14 22h-4c-3.771 0-5.657 0-6.828-1.172C2 19.657 2 17.771 2 14z" />
            </svg>`;
            el += `<a href="${url_for(category.path)}">${category.name} (${category.length})</a>`;
            el += `</div>`;
        });
        el += '</div>';
    el += '</widget>'; // Close widget-wrapper
    return el;
    }
    %>
    <%- layoutCategoriesDiv() %>
```

åœ¨ `themes/stellar/source/css/_layout/widgets/`â€‹ ä¸‹æ–°å»º `categories.styl`â€‹ æ–‡ä»¶ï¼Œå¡«å…¥ä»¥ä¸‹å†…å®¹ï¼š

```css
// categories widget æ ·å¼
.widget-wrapper.categories-widget .widget-body {
    border-radius: $border-card;
    padding: 12px 20px;
    background: var(--alpha50); // è¿™é‡Œè®¾ç½®èƒŒæ™¯
    box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.1); // æ·»åŠ é˜´å½±æ•ˆæœ
  }

// æ¯ä¸ªåˆ†ç±»çš„æ ·å¼
.category
  line-height: 1.5
  margin: 8px 0
  display: flex // ä½¿ç”¨flexå¸ƒå±€æ¥ç¡®ä¿å›¾æ ‡å’Œæ–‡æœ¬åœ¨åŒä¸€è¡Œ
  align-items: center // å‚ç›´å±…ä¸­å¯¹é½

.category-icon
  width: 16px
  height: 16px
  vertical-align: middle
  margin-right: 8px

.category a
  display: inline-block // é“¾æ¥ä»¥è¡Œå†…å—æ–¹å¼æ˜¾ç¤º
  word-break: break-word
  color: var(--text-p2)
  font-family: system-ui
  font-weight: 300
  font-size: 16px
  text-decoration: none
  &:hover
    color: $color-hover
    text-decoration: underline

// Variables
$color-hover = #0366d6


```

> å‚è€ƒï¼š[Stellar ä¸»é¢˜ä¸­æ·»åŠ åˆ†ç±»ç´¢å¼• Widget - å®‡å®™å°½å¤´çš„é¤é¦†](https://www.flyalready.cn/Stellar%20%E4%B8%BB%E9%A2%98%E4%B8%AD%E6%B7%BB%E5%8A%A0%E5%88%86%E7%B1%BB%E7%B4%A2%E5%BC%95%20Widget)

### éšæœºæ–‡ç« æŒ‰é’®

åˆ›å»º `themes/stellar/scripts/helpers/random.js`â€‹ ï¼Œå¢åŠ ä»¥ä¸‹ä»£ç ï¼š

```js
hexo.extend.filter.register('after_render:html', function (data) {
    const posts = []
    hexo.locals.get('posts').map(function (post) {
        if (post.random !== false) posts.push(post.path)
    })
    data += `<script>var posts=${JSON.stringify(posts)};function toRandomPost(){ var randomPath = posts[Math.floor(Math.random()*posts.length)]; var encodedPath = encodeURIComponent(randomPath); window.open('/' + encodedPath, "_self"); };</script>`
    return data
})
```

> å‚è€ƒï¼š[Hexo Stellar ä¸»é¢˜è£…ä¿®ç¬”è®° - å®‡å®™å°½å¤´çš„é¤é¦†ï¼šéšæœºæ–‡ç« æŒ‰é’®](https://www.flyalready.cn/Hexo%20Stellar%20%E4%B8%BB%E9%A2%98%E8%A3%85%E4%BF%AE%E7%AC%94%E8%AE%B0/#%E9%9A%8F%E6%9C%BA%E6%96%87%E7%AB%A0%E8%B7%B3%E8%BD%AC)
>
> å¤‡æ³¨ï¼šæ–‡ç« è·¯å¾„éœ€è¦ç”¨`encodeURIComponent`â€‹æ¥ç¼–ç ï¼Œå¦åˆ™å¦‚æœæ–‡ç« è·¯å¾„é‡Œæœ‰è¿å­—ç¬¦ï¼Œæ²¡æœ‰åœ¨å‰é¢åŠ ä¸ŠåŸŸååœ°å€ï¼Œå¯¼è‡´æ‰“å¼€å¤±è´¥ã€‚

### å¢å¼ºæ ‡ç­¾æ˜¾ç¤º

ç°åœ¨ç›¸æ¯”äºåˆ†ç±»æˆ‘å¯èƒ½ä¼šæ›´å–œæ¬¢ç”¨æ ‡ç­¾ï¼Œå› ä¸ºä¸€ç¯‡æ–‡ç« å¯ä»¥æ‰“å¤šä¸ªæ ‡ç­¾ã€‚æˆ‘åœ¨æ€æºç¬”è®°é‡Œç®¡ç†ç¬”è®°ä¹Ÿæ˜¯ç”¨ç®¡ç†é“¾æ¥çš„æ–¹å¼è€Œå¼ƒç”¨äº†æ–‡æ¡£æ ‘åˆ†ç±»ï¼Œæ‰€ä»¥æ ‡ç­¾æ›´ç¬¦åˆæˆ‘ç®¡ç†ç¬”è®°çš„ä¹ æƒ¯ã€‚stellaré»˜è®¤åœ¨æ–‡ç« åˆ—è¡¨åªæ˜¾ç¤ºåˆ†ç±»ï¼Œå¯¹æˆ‘æ¥è¯´å°±æœ‰ç‚¹éš¾å—äº†ã€‚

#### ä¸»é¡µæ–‡ç« åˆ—è¡¨æ·»åŠ æ ‡ç­¾

ä¿®æ”¹`themes/stellar/layout/_partial/main/post_list/post_card.ejs`â€‹

```js
// cat
if (post.categories && post.categories.length > 0) {
  if (post.layout === 'post' && post.categories && post.categories.length > 0) {
    var cats = [];
    if (post.categories) {
      post.categories.forEach((cat, i) => {
        cats.push(cat.name);
      });
    }
    if (cats.length > 0) {
      let cat = cats.shift();
      el += '<span class="cap breadcrumb"' + category_color(cat) + '>';
      el += icon('default:category')
      el += `<span>${cat}</span>`
      el += '</span>';
    }
  }
}
  if (post.sticky) {
  el += `<span class="pin">${icon('default:pin')}</span>`
}
el += '</div>';
// cat tags
el += '<div style="margin: 4px 0px;">';
if (post.tags && post.tags.length > 0) {
  el += '<span class="cap tags">';

  el += post.tags.map(tag => `<span style="background-color: var(--tag-bg-color); padding: 0px 6px; margin: 0px 5px 0px 0px;border-radius: 5px; color: var(--tag-text-color); line-height: 1.5;">#<span>${tag.name}</span></span>`).join('');

  el += '</span>';
}

el += '</div>';
el += '</article>';
return el;
```

è‡ªå®šä¹‰æ ·å¼

```css
/* é»˜è®¤çš„æµ…è‰²æ¨¡å¼é¢œè‰² */
:root {
    --tag-bg-color: #F2EEFD;
    --tag-text-color: #835EEC;
  }
  
  /* æš—é»‘æ¨¡å¼ä¸‹çš„é¢œè‰² */
  @media (prefers-color-scheme: dark) {
    :root {
      --tag-bg-color: #282433;
      --tag-text-color: #A28BF2;
    }
  }
  

#post-meta {
  font-size: 12px; 
  color: var(--text-p4); /* æˆ– --text-p2ï¼Œè®¾ç½®ä¸ºç°è‰² */
}
```

#### åœ¨æ–‡ç« é¡µé¢æ·»åŠ æ ‡ç­¾æ˜¾ç¤º

åœ¨ `layout/_partial/main/navbar/article_banner.ejs`â€‹ æ–‡ä»¶ä¸­ï¼Œæ‰¾åˆ°

```js
// 3.left.top: é¢åŒ…å±‘å¯¼èˆª
  el += `<div class="flex-row" id="breadcrumb">`
    // é¦–é¡µ
    el += `<a class="cap breadcrumb" href="${url_for(config.root)}">${__("btn.home")}</a>`
    if (theme.wiki.tree[page.wiki]) {
      el += partial('breadcrumb/wiki')
    } else if (page.layout == 'post') {
      el += partial('breadcrumb/blog')
    } else {
      el += partial('breadcrumb/page')
    }
  // end 3.left.top
  el += `</div>`

```

å¹¶åœ¨åé¢æ·»åŠ ï¼š

```js
// åœ¨è¿™é‡Œæ·»åŠ æ ‡ç­¾ä»£ç 
 if (page.layout == "post" && page.tags && page.tags.length > 0) {
   el += '<div id="tag">'; // å°†æ ‡ç­¾å®¹å™¨çš„åˆ›å»ºç§»åŠ¨åˆ°æ¡ä»¶å†…éƒ¨
   el += ' <span>&nbspæ ‡ç­¾ï¼š</span>';
   el += list_categories(page.tags, {
     class: "cap breadcrumb",
     show_count: false,
     separator: '&nbsp; ',
     style: "none"
   });
   el += '&nbsp</div>';
 }
 
```

> å‚è€ƒï¼š[Hexo Stellar ä¸»é¢˜è£…ä¿®ç¬”è®° - å®‡å®™å°½å¤´çš„é¤é¦†ï¼šåœ¨æ–‡ç« é¡µé¢æ·»åŠ æ ‡ç­¾æ˜¾ç¤º](https://www.flyalready.cn/Hexo%20Stellar%20%E4%B8%BB%E9%A2%98%E8%A3%85%E4%BF%AE%E7%AC%94%E8%AE%B0/#%E5%9C%A8%E6%96%87%E7%AB%A0%E9%A1%B5%E9%9D%A2%E6%B7%BB%E5%8A%A0%E6%A0%87%E7%AD%BE%E6%98%BE%E7%A4%BA)

### è‡ªå®šä¹‰css

#### æ–‡ç« å†…æ›´æ–°æ—¥æœŸå§‹ç»ˆæ˜¾ç¤º

```css
/* æ–‡ç« å†…æ›´æ–°æ—¥æœŸå§‹ç»ˆæ˜¾ç¤º */
.bread-nav div#post-meta span.updated {
    visibility: visible !important;
}
```

#### è‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼

```css
/* from https: //github.com/weekdaycare/weekdaycare.github.io/blob/main/css/scrollbar.css */

/* æ»šåŠ¨æ¡ */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background-color: rgba(200, 155, 155, 0);
    border-radius: 2em;
}

::-webkit-scrollbar-thumb {
    background-color: #c3c0c1 !important;
    /* background-image: -webkit-linear-gradient(45deg,
            rgba(255, 255, 255, 0.4) 25%,
            transparent 25%,
            transparent 50%,
            rgba(255, 255, 255, 0.4) 50%,
            rgba(255, 255, 255, 0.4) 75%,
            transparent 75%,
            transparent) !important; */
    border-radius: 2em;
}

::-webkit-scrollbar-corner {
    background-color: transparent;
}

[data-theme="dark"] ::-webkit-scrollbar-thumb {
    background-color: #1f1f1f !important;
}
```

#### é™åˆ¶ä»£ç å—çš„æœ€å¤§é«˜åº¦

```css
.md-text .highlight {
    max-height: 800px;
    overflow: auto;
}
```

#### é“¾æ¥æ ·å¼ä¼˜åŒ–

```css
/* æ–‡ç« å†…é“¾æ¥ï¼šä¸ºé“¾æ¥ä½¿ç”¨è§å…‰ç¬”ä¸‹åˆ’çº¿æ•ˆæœ */
/* æ–‡ç« å†…é“¾æ¥ */
li:not([class]) a:not([class]),
p:not([class]) a:not([class]),
table a:not([class]) {
  /*color: var(--theme-link);*/
  padding-bottom: 3px; /* å¢åŠ åº•éƒ¨padding */
  padding-right: 1px;
  margin-right: 2px;
 color: var(--theme-link);
  background: linear-gradient(0, var(--theme-link), var(--theme-link)) no-repeat center bottom / 100% 2px;
}
```

> å‚è€ƒï¼š[Hexo Stellar ä¸»é¢˜è£…ä¿®ç¬”è®° - å®‡å®™å°½å¤´çš„é¤é¦†ï¼šè¶…é“¾æ¥æ ·å¼è°ƒæ•´](https://www.flyalready.cn/Hexo%20Stellar%20%E4%B8%BB%E9%A2%98%E8%A3%85%E4%BF%AE%E7%AC%94%E8%AE%B0/#%E8%B6%85%E9%93%BE%E6%8E%A5%E6%A0%B7%E5%BC%8F%E8%B0%83%E6%95%B4)

### æ·»åŠ æœ€æ–°è¯„è®ºç»„ä»¶

å‚è€ƒï¼š[Stellarå±•ç¤ºæœ€æ–°è¯„è®º - æ˜Ÿæ—¥è¯­ (weekdaycare.cn)](https://weekdaycare.cn/posts/twikoo-new/#giscus)

**vercel appå‡†å¤‡**

1. éƒ¨ç½² repo è‡³ Vercelï¼š[Achuan-2/recent-comment (github.com)](https://github.com/Achuan-2/recent-comment)
2. éœ€è¦åœ¨vercelä¸­è®¾ç½®ç¯å¢ƒå˜é‡

    |name|description|
    | :-----| :--------------------|
    |â€‹`LIMIT`â€‹|è·å–æ•°é‡|
    |â€‹`GITHUB_REPO_OWNER`â€‹|Githubç”¨æˆ·å|
    |â€‹`GITHUB_REPO_NAME`â€‹|ä»“åº“å|
    |â€‹`GITHUB_CATEGORY_ID`â€‹|Discussionsåˆ†ç±»åç§°|
    |â€‹`GITHUB_TOKEN`â€‹|Github Access Token|
3. é…ç½®å®Œæˆåè¯·redeployï¼
4. æŸ¥çœ‹æ˜¯å¦èƒ½æ­£ç¡®è¾“å‡ºæœ€æ–°è¯„è®ºçš„jsonæ•°æ®

**stellarä¸»é¢˜ä¿®æ”¹**

1. åœ¨ `theme/source/js/services/`â€‹ ä¸‹æ–°å»º giscus_new.js

    ```js
    utils.jq(() => {
        $(function () {
            const els = document.getElementsByClassName('ds-giscus');
            for (var i = 0; i < els.length; i++) {
                const el = els[i];
                const api = el.getAttribute('api');
                if (api == null) {
                    continue;
                }
                const default_avatar = def.avatar;
                // layout
                utils.request(el, api, function (data) {
                    const limit = el.getAttribute('limit');
                    data.forEach((item, i) => {
                        if (limit && i >= limit) {
                            return;
                        }
                        comment = item.body.length > 50 ? item.body.substring(0, 50) + '...' : item.body;
                        var cell = '<div class="timenode" index="' + i + '">';
                        cell += '<div class="header">';
                        cell += '<div class="user-info">';
                        cell += '<img src=" + (item.author.avatarUrl || default_avatar) + " onerror="javascript:this.src=\\" + default_avatar + "\\";">';
                        cell += '<span>' + item.author.login + '</span>';
                        cell += '</div>';
                        cell += '<span>' + new Date(item.createdAt).toLocaleString() + '</span>';
                        cell += '</div>';
                        cell += '<a class="body" href="' + item.url + '" target="_blank" rel="external nofollow noopener noreferrer">';
                        cell += comment;
                        cell += '</a>';
                        cell += '</div>';
                        $(el).append(cell);
                    });
                });
            }
        });
    });
    ```
2. â€‹`_config.stellar.yml`â€‹ä¸»é¢˜é…ç½®ä¸­å¼•å…¥

    ```yaml
    data_services:
      ...
      giscus:
        js: /js/services/giscus_new.js

    ```
3. åœ¨ `_data/widgets.yml`â€‹ ä¸­åˆ›å»ºå°ç»„ä»¶ï¼Œå¹¶åœ¨`_config.stellar.yml`â€‹ä¸­é€‰æ‹©åœ¨å“ªé‡Œå±•ç¤º

    ```yaml
    new_comment:
      layout: timeline
      title: æœ€æ–°è¯„è®º
      api: https://xxx.vercel.app # ä½ çš„ vercel å‡½æ•°åœ°å€
      type: giscus
      limit: 16 # é™åˆ¶è·å–æ•°é‡ï¼Œè¿™æ˜¯å®¢æˆ·ç«¯ï¼Œåˆšåˆšæ˜¯æœåŠ¡ç«¯

    ```

**æˆæœå±•ç¤º**

â€‹![Clip_2024-04-28_01-36-04](https://raw.githubusercontent.com/Achuan-2/Picbed/pic/assets/Clip_2024-04-28_01-36-04-20240428013606-bqbi3ns.png)â€‹

### Fix ä½¿ç”¨æœç´¢åŠŸèƒ½æœåˆ°çš„éƒ¨åˆ†æ–‡ç« æ— æ³•æ‰“å¼€

æˆ‘ç›®å‰ä½¿ç”¨æ€æºç¬”è®°è¿™ä¸ªç¬”è®°è½¯ä»¶çš„ã€Œå‘å¸ƒå·¥å…·ã€æ’ä»¶æŠŠç¬”è®°å‘å¸ƒåˆ°hexo  
å‘å¸ƒå·¥å…·æ”¯æŒåœ¨yamlé‡Œæ”¾æ°¸ä¹…é“¾æ¥

ç”±äºæ°¸ä¹…é“¾æ¥æ˜¯`/post/id.html`â€‹å½¢å¼ï¼Œè€Œä½¿ç”¨local searchæœç´¢çš„æ—¶å€™ï¼Œè¿™äº›æ–‡æ¡£åˆ™ä¼šæ‰“å¼€ä¸º`https://post/id.html`â€‹,å¯¼è‡´å¤±è´¥  
æ‰€ä»¥éœ€è¦å¯¹data.pathè¿›è¡Œæ£€æµ‹ï¼Œå¦‚æœä»¥'//'å¼€å¤´ï¼Œåˆ™pathå­—ç¬¦ä¸²åªå–ç¬¬äºŒä½åˆ°æœ€åä¸€ä½ï¼Œä½¿å…¶èƒ½æ­£å¸¸æ‰“å¼€

åœ¨`themes\stellar\source\js\search\local-search.js`â€‹è¿›è¡Œä¿®æ”¹

```diff
- var dataUrl = data.path;
+ var dataUrl = data.path.startsWith('//') ? data.path.slice(1) : data.path;
```

å·²æäº¤Pull requestï¼š[https://github.com/xaoxuu/hexo-theme-stellar/pull/450](https://github.com/xaoxuu/hexo-theme-stellar/pull/450)

â€
