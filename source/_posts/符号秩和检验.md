---
title: å‡è®¾æ£€éªŒä¸¨Wilcoxon Signed Rank Testï¼ˆWilcoxonç¬¦å·ç§©æ£€éªŒï¼‰
date: '2024-07-21 01:26:09'
updated: '2024-10-05 09:19:38'
permalink: /post/ç¬¦å·ç§©å’Œæ£€éªŒ.html
comments: true
toc: true
---



Wilcoxonç¬¦å·ç§©æ£€éªŒä¸€ç§éå‚æ•°ç»Ÿè®¡æ£€éªŒæ–¹æ³•ï¼Œä¸»è¦ç”¨äºæ¯”è¾ƒä¸¤ä¸ªé…å¯¹æ ·æœ¬è§‚æµ‹å€¼ä¹‹é—´çš„å·®å¼‚ã€‚å®ƒæ˜¯sign testï¼ˆç¬¦å·æ£€éªŒï¼‰çš„æ”¹è¿›ï¼Œæ˜¯åœ¨è§‚å¯Ÿâ€œ+â€â€œ-â€å·ä¸ªæ•°çš„åŸºç¡€ä¸Šäº¦è€ƒè™‘å·®å€¼çš„å¤§å°ï¼Œé€šè¿‡å¯¹å·®å€¼åç§©æ±‚å’Œè¿›è¡Œæ£€éªŒçš„ã€‚Wilcoxonç¬¦å·ç§©æ£€éªŒæ˜¯æ›¿ä»£ã€Œ**é…å¯¹tæ£€éªŒ**ã€çš„éå‚æ•°æ–¹æ³•ï¼Œé€‚ç”¨äºæ•°æ®ä¸æ»¡è¶³æ­£æ€åˆ†å¸ƒçš„æƒ…å†µã€‚

ğŸ’¡æ€»ç»“Wilcoxonç¬¦å·ç§©æ£€éªŒå’Œå…¶ä»–æ£€éªŒæ–¹æ³•çš„å…³ç³»

* Wilcoxonç¬¦å·ç§©æ£€éªŒä¸Mann-Whitney Uæ£€éªŒï¼šä¸¤è€…éƒ½æ˜¯éå‚æ•°æ£€éªŒæ–¹æ³•ï¼ŒWilcoxonç”¨äºé…å¯¹æ ·æœ¬ï¼ŒMann-Whitney Uç”¨äºç‹¬ç«‹æ ·æœ¬
* Wilcoxonç¬¦å·ç§©æ£€éªŒä¸é…å¯¹tæ£€éªŒï¼šWilcoxonæ˜¯é…å¯¹tæ£€éªŒçš„éå‚æ•°æ›¿ä»£æ–¹æ³•
* Wilcoxonç¬¦å·ç§©æ£€éªŒä¸ç¬¦å·æ£€éªŒï¼ˆSign testï¼‰ï¼šWilcoxonç¬¦å·ç§©æ£€éªŒæ˜¯ç¬¦å·æ£€éªŒçš„æ”¹è¿›ç‰ˆæœ¬ï¼ŒWilcoxonç¬¦å·ç§©æ£€éªŒè€ƒè™‘äº†å·®å€¼çš„å¤§å°ï¼Œè€Œç¬¦å·æ£€éªŒä»…è€ƒè™‘æ­£è´Ÿå·

## é€‚ç”¨æ¡ä»¶

* æ•°æ®ä¸ºè¿ç»­å‹æˆ–æœ‰åºçš„ç¦»æ•£å‹ã€‚
* ä¸¤ä¸ªæ ·æœ¬æ˜¯é…å¯¹çš„ï¼Œå³æ¯å¯¹æ•°æ®ç‚¹ä¹‹é—´æ˜¯ç›¸å…³çš„ã€‚
* æ•°æ®ä¸éœ€è¦æœä»æ­£æ€åˆ†å¸ƒï¼Œä½†**å‡è®¾æ•°æ®æ˜¯å¯¹ç§°çš„**ã€‚

## åŸºæœ¬æ€æƒ³

é¦–å…ˆè®¡ç®—é…å¯¹æ•°æ®å·®å€¼ï¼Œç„¶åå¯¹å·®å€¼çš„ç»å¯¹å€¼è¿›è¡Œæ’åºå¹¶èµ‹äºˆç§©æ¬¡ï¼Œæœ€ååˆ†åˆ«è®¡ç®—æ­£ç§©æ¬¡ä¹‹å’Œä¸è´Ÿç§©æ¬¡ä¹‹å’Œã€‚é€šè¿‡æ¯”è¾ƒæ­£ç§©å’Œä¸è´Ÿç§©å’Œçš„å¤§å°æ¥åˆ¤æ–­ä¸¤ç»„æ•°æ®æ˜¯å¦å­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚

## ä¾‹å­

### ç”µè§£æ³•å’Œåˆ†å…‰å…‰åº¦æ³•æµ‹è¯•æ ·æœ¬æµ“åº¦æœ‰æ²¡æœ‰å·®å¼‚ï¼Ÿ

> [Wilcoxoné…å¯¹ç¬¦å·ç§©å’Œæ£€éªŒï½œè¯´äººè¯çš„ç»Ÿè®¡å­¦_å“”å“©å“”å“©_bilibili](https://www.bilibili.com/video/BV16C4y1V7Ya/?vd_source=b4a1fcb6dce305e26d8d16d9cbb71304)

â€‹![Clip_2024-07-21_00-22-31](https://raw.githubusercontent.com/Achuan-2/Picbed/pic/assets/Clip_2024-07-21_00-22-31-20240721002344-47m61qd.png)â€‹

ç°åœ¨è¦æµ‹é‡æ±¡æ°´é‡Œé¢æ°Ÿç¦»å­çš„æµ“åº¦ï¼Œæœ‰ä¸¤ç§æµ‹é‡æ–¹æ³•ï¼Œåˆ†åˆ«å¯¹11ä¸ªæ±¡æ°´æ ·æœ¬è¿›è¡Œæµ‹é‡ã€‚è¿™æ˜¯æµ‹é‡çš„ç»“æœï¼Œæˆ‘ä»¬æƒ³çŸ¥é“ä¸¤ç§æµ‹é‡ç»“æœæ˜¯å¦ä¸€è‡´ã€‚

â€‹![Clip_2024-07-21_00-27-56](https://raw.githubusercontent.com/Achuan-2/Picbed/pic/assets/Clip_2024-07-21_00-27-56-20240721002757-dctddrt.png)â€‹

æŒ‰ç…§ä»¥å¾€çš„ç»éªŒï¼Œä¼šè€ƒè™‘ç”¨é…å¯¹Tæ£€éªŒã€‚å¦‚æœå¯¹è¿™ä¸ªæ£€éªŒæ–¹æ³•ä¸äº†è§£ï¼Œå¯ä»¥ç¿»çœ‹å‰é¢çš„è§†é¢‘ã€‚ä½†é…å¯¹Tæ£€éªŒæœ‰ä¸ªå‰æï¼šæ•°æ®è¦æœä»æ­£æ€åˆ†å¸ƒã€‚æ ¹æ®é¢‘ç‡ç›´æ–¹å›¾å’Œæ­£æ€æ€§æµ‹è¯•ï¼Œè¿™äº›æ•°æ®æ˜æ˜¾ä¸æœä»æ­£æ€ã€‚

â€‹![Clip_2024-07-21_00-27-18](https://raw.githubusercontent.com/Achuan-2/Picbed/pic/assets/Clip_2024-07-21_00-27-18-20240721002738-n3rv4iv.png)â€‹

æ—¢ç„¶ä¸èƒ½ç”¨é…å¯¹Tæ£€éªŒï¼Œé‚£å°±ç”¨ä¸€ä¸ªæ²¡æœ‰æ­£æ€åˆ†å¸ƒè¦æ±‚çš„æ£€éªŒæ–¹æ³•å§ã€‚Wilcoxoné…å¯¹ç¬¦å·ç§©å’Œæ£€éªŒæ¯”è¾ƒçš„æ˜¯**<u>ä¸­ä½æ•°</u>**ï¼Œè€ŒTæ£€éªŒæ¯”è¾ƒçš„æ˜¯**<u>å‡å€¼</u>**ã€‚

**<u>é…å¯¹</u>**â€‹**æ¯”è¾ƒæ˜¯è®¡ç®—æ¯ä¸ªæ ·æœ¬çš„**â€‹**<u>ä¸¤ç§æµ‹é‡ç»“æœçš„å·®å€¼</u>**ã€‚å½“ç„¶å·®å€¼æœ‰æ­£è´Ÿä¹‹åˆ†ï¼Œç„¶åå¯¹è¿™äº›å·®å€¼æŒ‰ç…§ç»å¯¹å€¼çš„å¤§å°ï¼Œä»å°åˆ°å¤§æ’åºã€‚

* é¦–å…ˆï¼Œå·®å€¼ä¸ºé›¶çš„ä¸å‚ä¸æ’åºã€‚
* ç»å¯¹å€¼æœ€å°çš„ä¸¤ä¸ªå·®å€¼å äº†å‰ä¸¤ä½ï¼Œé‚£åˆ°åº•è°æ˜¯ç¬¬ä¸€ï¼Œè°æ˜¯ç¬¬äºŒå‘¢ï¼Ÿåˆ«æŠ¢äº†ï¼Œå¤§å®¶éƒ½å–ä¸­é—´å€¼1.5ï¼Œä½†è¦æ³¨æ„ç§©æ¬¡ä¹Ÿæœ‰æ­£è´Ÿã€‚
* æ’ç¬¬ä¸‰çš„æ˜¯å®ƒï¼Œæ’ç¬¬å››å’Œç¬¬äº”çš„æ˜¯è¿™ä¸¤ä¸ªæ ·æœ¬ã€‚åŒç†æŠŠæ‰€æœ‰çš„ç§©æ¬¡éƒ½è®¡ç®—å‡ºæ¥ï¼Œç°åœ¨æŠŠæ­£çš„å’Œè´Ÿçš„ç§©å’Œæ±‚å’Œï¼Œå¾—åˆ°æ­£ç§©å’Œä¸è´Ÿç§©å’Œã€‚

â€‹![Clip_2024-07-21_00-29-28](https://raw.githubusercontent.com/Achuan-2/Picbed/pic/assets/Clip_2024-07-21_00-29-28-20240721002929-pfus7ex.png)â€‹

æˆ‘ä»¬çš„åŸå‡è®¾æ˜¯ä¸¤ç§æµ‹é‡æ–¹æ³•æ²¡æœ‰å·®å¼‚ï¼Œä¹Ÿå°±æ˜¯æ€»ä½“çš„ä¸­ä½æ•°ç›¸åŒã€‚å¦‚æœä¸¤ç§æµ‹é‡æ–¹æ³•çœŸçš„æ²¡æœ‰å·®å¼‚ï¼ŒåŒä¸€ä¸ªæ ·æœ¬çš„æµ‹é‡ç»“æœè¦ä¹ˆä½ å¤§ï¼Œè¦ä¹ˆæˆ‘å¤§ï¼Œéƒ½æ˜¯å¾ˆéšæœºçš„ã€‚æ‰€ä»¥å·®å€¼çš„åˆ†å¸ƒåº”è¯¥æ˜¯å¤§ä½“å·¦å³å¯¹ç§°çš„å§ï¼Œè€Œä¸”è¿™ä¸ª**<u>å·®å€¼åˆ†å¸ƒ</u>**â€‹**çš„ä¸­ä½æ•°åº”è¯¥ç­‰äºé›¶**ï¼Œ**æ­£ç§©å’Œå’Œè´Ÿç§©å’Œçš„ç»å¯¹å€¼åº”è¯¥å·®åˆ«ä¸å¤§**ã€‚å¦‚æœæ ·æœ¬çš„è®¡ç®—ç»“æœå‘Šè¯‰æˆ‘ï¼Œä¸¤ä¸ªå€¼çš„å¤§å°å·®å¾ˆè¿œï¼Œé‚£å°±æœ‰ç†ç”±æ€€ç–‘åŸå‡è®¾çš„çœŸå®æ€§äº†ï¼Œæ‹’ç»åŸå‡è®¾ã€‚

### èˆªè¡Œå¯¹å¿ƒç‡æœ‰æ— å½±å“

> [drhuang.com/chinese/health/medicine/book/é¢„é˜²åŒ»å­¦/577.htm](http://drhuang.com/chinese/health/medicine/book/%E9%A2%84%E9%98%B2%E5%8C%BB%E5%AD%A6/577.htm)

â€‹![Clip_2024-07-21_10-22-51](https://raw.githubusercontent.com/Achuan-2/Picbed/pic/assets/Clip_2024-07-21_10-22-51-20240721102252-prby5i7.png)â€‹

### æ²»ç–—å‰å

> [The Wilcoxon signed-rank test &amp; the sign test (youtube.com)](https://www.youtube.com/watch?v=CD2G2lRUuxI)

â€‹![Clip_2024-07-21_01-17-12](https://raw.githubusercontent.com/Achuan-2/Picbed/pic/assets/Clip_2024-07-21_01-17-12-20240721011715-65b22b6.png)â€‹

## ä»£ç å®ç°

### Matlab

æ–‡æ¡£ï¼š[signrank](https://ww2.mathworks.cn/help/stats/signrank.html)

åœ¨ MATLAB ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ `signrank`â€‹ å‡½æ•°è¿›è¡Œ Wilcoxon ç¬¦å·ç§©æ£€éªŒã€‚

```matlab
% ç”Ÿæˆæ•°æ®
rng(42); % è®¾ç½®éšæœºç§å­
n = 20;
data_before = normrnd(50, 10, [1, n]);
data_after = data_before + normrnd(0, 5, [1, n]);

% Wilcoxon ç¬¦å·ç§©æ£€éªŒ
[p, h, stats] = signrank(data_before, data_after);

% è¾“å‡ºç»“æœ
fprintf('p-value: %f\n', p);
disp(stats);

```

### Python

åœ¨ Python ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ `scipy.stats.wilcoxon`â€‹ å‡½æ•°è¿›è¡Œ Wilcoxon ç¬¦å·ç§©æ£€éªŒã€‚

```python
pythonfrom scipy.stats import wilcoxon

# Wilcoxon ç¬¦å·ç§©æ£€éªŒ
stat, p_value = wilcoxon(data_before, data_after)

# è¾“å‡ºç»“æœ
print(f'p-value: {p_value}')
```

### R

åœ¨ R ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ `wilcox.test`â€‹ å‡½æ•°è¿›è¡Œ Wilcoxon ç¬¦å·ç§©æ£€éªŒã€‚

```r
r# ç”Ÿæˆæ•°æ®
set.seed(42) # è®¾ç½®éšæœºç§å­
n <- 20
data_before <- rnorm(n, mean=50, sd=10)
data_after <- data_before + rnorm(n, mean=0, sd=5)

# Wilcoxon ç¬¦å·ç§©æ£€éªŒ
test_result <- wilcox.test(data_before, data_after, paired=TRUE)

# è¾“å‡ºç»“æœ
print(test_result)
```

## é—®é¢˜

* å¦‚ä½•ç¡®å®šæ•°æ®æ˜¯å¯¹ç§°åˆ†å¸ƒçš„

  1. ç»˜åˆ¶å›¾å½¢

  * **ç›´æ–¹å›¾ï¼ˆHistogramï¼‰** ï¼š  
    ç›´æ–¹å›¾å¯ä»¥ç›´è§‚åœ°å±•ç¤ºæ•°æ®çš„åˆ†å¸ƒæƒ…å†µã€‚å¯¹ç§°åˆ†å¸ƒçš„ç›´æ–¹å›¾é€šå¸¸å‘ˆç°ä¸ºä¸­é—´é«˜ã€ä¸¤è¾¹ä½çš„å½¢çŠ¶ï¼Œç±»ä¼¼äºé’Ÿå½¢æ›²çº¿ã€‚
  * **ç›’é¡»å›¾ï¼ˆBoxplotï¼‰** ï¼š  
    ç›’é¡»å›¾å¯ä»¥å¸®åŠ©åˆ¤æ–­æ•°æ®çš„å¯¹ç§°æ€§ã€‚å¯¹ç§°åˆ†å¸ƒçš„ç›’é¡»å›¾ä¸­ä½æ•°çº¿åº”è¯¥ä½äºç›’å­çš„ä¸­å¤®ï¼Œä¸¤è¾¹çš„é¡»é•¿åº¦ç›¸ä¼¼ã€‚

  2. è®¡ç®—ç»Ÿè®¡é‡

  * **ååº¦ï¼ˆSkewnessï¼‰** ï¼š  
    ååº¦æ˜¯è¡¡é‡æ•°æ®åˆ†å¸ƒå¯¹ç§°æ€§çš„ç»Ÿè®¡é‡ã€‚ååº¦æ¥è¿‘äºé›¶è¡¨ç¤ºæ•°æ®æ¥è¿‘å¯¹ç§°åˆ†å¸ƒã€‚è®¡ç®—ååº¦çš„å…¬å¼ä¸ºï¼š
  * **å³°åº¦ï¼ˆKurtosisï¼‰** ï¼š

  3. æ­£æ€æ€§æ£€éªŒ

  è™½ç„¶æ­£æ€åˆ†å¸ƒå¹¶ä¸å®Œå…¨ç­‰åŒäºå¯¹ç§°åˆ†å¸ƒï¼Œä½†æ­£æ€æ€§æ£€éªŒå¯ä»¥ä½œä¸ºä¸€ç§è¾…åŠ©å·¥å…·ã€‚

  * **Shapiro-Wilk Test**ï¼š  
    Shapiro-Wilkæ£€éªŒç”¨äºæ£€éªŒæ•°æ®æ˜¯å¦æ¥è‡ªæ­£æ€åˆ†å¸ƒã€‚på€¼å¤§äº0.05åˆ™æ— æ³•æ‹’ç»åŸå‡è®¾ï¼Œè¡¨ç¤ºæ•°æ®å¯èƒ½æ˜¯æ­£æ€åˆ†å¸ƒï¼Œä»è€Œå¯èƒ½æ˜¯å¯¹ç§°åˆ†å¸ƒã€‚
  * **Kolmogorov-Smirnov Test**ï¼š  
    KSæ£€éªŒä¹Ÿå¯ç”¨äºæ­£æ€æ€§æ£€éªŒï¼ŒåŒæ ·på€¼å¤§äº0.05è¡¨ç¤ºæ•°æ®å¯èƒ½æ˜¯æ­£æ€åˆ†å¸ƒã€‚

â€
